(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports,require("martinez-polygon-clipping"),require("@turf")):"function"==typeof define&&define.amd?define(["exports","martinez-polygon-clipping","@turf"],b):(a=a||self,b(a.dline={},a.martinez,a.turf))})(this,function(a,b,c){'use strict';var d=Math.abs,e=Math.floor;function f(a){"@babel/helpers - typeof";return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f(a)}function g(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function i(a){return j(a)||k(a)||l(a)||n()}function j(a){if(Array.isArray(a))return m(a)}function k(a){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a))return Array.from(a)}function l(a,b){if(a){if("string"==typeof a)return m(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?m(a,b):void 0}}function m(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function n(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(a,b){var c=Math.cos,d=Math.sin,e=function(a){return a.map(function(a){return a*Math.PI/180})},f=e(a),g=e(b);return 6372795*Math.acos(d(f[0])*d(g[0])+c(f[0])*c(g[0])*c(f[1]-g[1]))}function p(a,b,c){function f(a){var b=Math.ceil(a);return b%2?b:e(a)}if("meters"===c){var g=[a[3],a[0]],h=[a[1],a[0]],j=o(h,g),k=f(j/b),l=d(a[1]-a[3])*b/j,m=[a[1],a[0]],n=[a[1],a[2]],p=o(n,m),q=f(p/b),r=d(a[0]-a[2])*b/p;return{latSize:k,longSize:q,latCellSize:l,longCellSize:r}}if("degrees"===c){var s;Array.isArray(b)?1===b.length?s=[b[0],b[0]]:2===b.length&&(s=i(b)):s=[b,b];var t=d(a[1]-a[3]),u=f(t/s[0]),v=d(a[0]-a[2]),w=f(v/s[1]);return{latSize:u,longSize:w,latCellSize:s[0],longCellSize:s[1]}}throw new Error("wtf")}function q(a,b){var c=Math.max,d=Math.min;if(!Array.isArray(a))throw new Error("percents is not array");var e=d.apply(Math,i(b.map(function(a){return a[0]}))),f=d.apply(Math,i(b.map(function(a){return a[1]}))),g=c.apply(Math,i(b.map(function(a){return a[0]}))),h=c.apply(Math,i(b.map(function(a){return a[1]}))),j=h-f,k=g-e,l=j*(100+a[0])/100,m=k*(100+a[1])/100;return[f-(l-j)/2,e-(m-k)/2,h+(l-j)/2,g+(m-k)/2]}function r(a,b){var c=a.bbox,d=a.units,e=a.exponent,g=a.mask,h=a.boundaries;switch(f(c)){case"undefined":c=q([0,0],b);break;case"object":if(!Array.isArray(c))throw new Error("bbox is not array");if(0===c.length)c=q([0,0],b);else if(2===c.length)c.forEach(function(a){if("number"!=typeof a||0>a)throw new Error("invalid bbox values")}),c=q(c,b);else if(4===c.length)c.forEach(function(a){if("number"!=typeof a)throw new Error("invalid bbox values")});else throw new Error("invalid bbox length");break;default:throw new Error("bbox is not array");}switch(f(d)){case"string":case"undefined":if("meters"===d||d===void 0)d=["meters","meters"];else if("degrees"===d)d=["degrees","degrees"];else throw new Error("invalid units values");break;case"object":if(!Array.isArray(d))throw new Error("units is not array");if(2===d.length)d.forEach(function(a){if("meters"!==a&&"degrees"!==a)throw new Error("invalid units values")});else throw new Error("invalid units length");break;default:throw new Error("invalid units values");}e||(e=2);var i,j;if(g)if(h){var k=function(a){var b=a.filter(function(a){return 0<a[0]}).sort(function(c,a){return a[0]-c[0]});return b.unshift([1/0]),!!b.length&&b},l=function(a){var b=a.filter(function(a){return 0>a[0]}).sort(function(c,a){return a[0]-c[0]});return b.push([-Infinity]),!!b.length&&b};i=l(h),j=k(h)}else throw new Error("boundaries is undefined");return{bbox:c,units:d,exponent:e,mask:g,lowerIntervals:i,upperIntervals:j}}function s(){for(var a="ncols         ".concat(((this.bbox[2]-this.bbox[0])/this.longCellSize).toFixed(),"\nnrows         ").concat(((this.bbox[3]-this.bbox[1])/this.latCellSize).toFixed(),"\nxllcorner     ").concat(this.bbox[0],"\nyllcorner     ").concat(this.bbox[1],"\ncellsize      ").concat(this.latCellSize,"\nNODATA_value  -9999\n"),b=this.grid.length-1;0<=b;b--)a+=" "+this.grid[b].join(" ")+"\n";return a}function t(){for(var a={type:"FeatureCollection",features:[]},b=0;b<this.grid.length;b++)for(var c=0;c<this.grid[b].length;c++)this.grid[b][c]&&a.features.push({type:"Feature",properties:{value:this.grid[b][c]},geometry:{type:"Point",coordinates:[c*this.longCellSize+this.bbox[0],b*this.latCellSize+this.bbox[1]]}});return a}function u(a){for(var b=[],c=!0;0<a.length;){!0===c&&(b.push([]),b[b.length-1].push([a[0][0],a[0][1]],[a[0][2],a[0][3]]),a.splice(0,1)),c=!0;for(var d=0,e=a.length;d<e;d++){if(b[b.length-1][b[b.length-1].length-1][0]===a[d][0]&&b[b.length-1][b[b.length-1].length-1][1]===a[d][1]){b[b.length-1].push([a[d][2],a[d][3]]),a.splice(d,1),c=!1;break}else if(b[b.length-1][b[b.length-1].length-1][0]===a[d][2]&&b[b.length-1][b[b.length-1].length-1][1]===a[d][3]){b[b.length-1].push([a[d][0],a[d][1]]),a.splice(d,1),c=!1;break}if(b[b.length-1][0][0]===a[d][0]&&b[b.length-1][0][1]===a[d][1]){b[b.length-1].unshift([a[d][2],a[d][3]]),a.splice(d,1),c=!1;break}else if(b[b.length-1][0][0]===a[d][2]&&b[b.length-1][0][1]===a[d][3]){b[b.length-1].unshift([a[d][0],a[d][1]]),a.splice(d,1),c=!1;break}}}return b}function v(a){for(var b,c={},d=0;d<a.length;d++){b=[];for(var e=0;e<a.length;e++)d!==e&&w(a[d][0][1],a[d][0][0],a[e])&&b.push(e);c[[d]]=b}for(var f,g=[],h=0;h<a.length;h++){for(var k in f=[],c)c[k][c[k].length-1]===h&&0==(c[k].length-1)%2&&f.push(a[k]);0!=(c[[h]].length-1)%2&&g.push([a[h]].concat(f))}return g}function w(a,b,d){for(var e=d.length,f=e-1,g=!1,h=0;h<e;h++)(d[h][0]<=b&&b<d[f][0]||d[f][0]<=b&&b<d[h][0])&&a>(d[f][1]-d[h][1])*(b-d[h][0])/(d[f][0]-d[h][0])+d[h][1]&&(g=!g),f=h;return g}function x(a,b,c){function e(a,b,c,d){switch(a){case"a-":return[].concat(i(o(b,c,0,d)),i(t(b,c,1,d)));case"b-":return[].concat(i(r(b,c,1,d)),i(o(b,c,1,d)));case"c-":return[].concat(i(s(b,c,1,d)),i(r(b,c,0,d)));case"d-":return[].concat(i(t(b,c,0,d)),i(s(b,c,0,d)));case"a+":return[].concat(i(o(b,c,1,d)),i(t(b,c,0,d)));case"b+":return[].concat(i(r(b,c,0,d)),i(o(b,c,0,d)));case"c+":return[].concat(i(s(b,c,0,d)),i(r(b,c,1,d)));case"d+":return[].concat(i(t(b,c,1,d)),i(s(b,c,1,d)));case"l>r":return[].concat(i(o(b,c,1,d)),i(s(b,c,1,d)));case"r>l":return[].concat(i(o(b,c,0,d)),i(s(b,c,0,d)));case"t>b":return[].concat(i(r(b,c,0,d)),i(t(b,c,0,d)));case"b>t":return[].concat(i(r(b,c,1,d)),i(t(b,c,1,d)));default:throw new Error("imposible");}}function f(b,c){if(0!==b&&0!==c&&b!==a.length-2&&c!==a[b].length-2)return 0;if(b===a.length-2&&0!==c&&c!==a[b].length-2)return"top";if(b!==a.length-2&&0!==b&&c===a[b].length-2)return"right";if(0===b&&c!==a[b].length-2&&0!==c)return"bot";if(b!==a.length-2&&0===c&&0!==b)return"left";if(b===a.length-2&&0===c)return"A";if(b===a.length-2&&c===a[b].length-2)return"B";if(0===b&&c===a[b].length-2)return"C";if(0===b&&0===c)return"D";throw new Error("invalid x or y")}function g(a,d){var e=(m(a,d)+n(a,d)+p(a,d)+q(a,d))/4;return e<=b?0:e>b&&e<=c?1:2}function h(a,d,f){var h;79===a?v.push(e("d-",d,f,c)):41===a?v.push(e("d+",d,f,c)):1===a?v.push(e("d+",d,f,b)):39===a?v.push(e("d-",d,f,b)):77===a?v.push(e("c-",d,f,c)):43===a?v.push(e("c+",d,f,c)):3===a?v.push(e("c+",d,f,b)):37===a?v.push(e("c-",d,f,b)):71===a?v.push(e("b-",d,f,c)):49===a?v.push(e("b+",d,f,c)):9===a?v.push(e("b+",d,f,b)):31===a?v.push(e("b-",d,f,b)):53===a?v.push(e("a-",d,f,c)):67===a?v.push(e("a+",d,f,c)):27===a?v.push(e("a+",d,f,b)):13===a?v.push(e("a-",d,f,b)):4===a?v.push(e("b>t",d,f,b)):36===a?v.push(e("t>b",d,f,b)):76===a?v.push(e("t>b",d,f,c)):44===a?v.push(e("b>t",d,f,c)):12===a?v.push(e("r>l",d,f,b)):28===a?v.push(e("l>r",d,f,b)):68===a?v.push(e("l>r",d,f,c)):52===a?v.push(e("r>l",d,f,c)):72===a?v.push(e("t>b",d,f,c),e("t>b",d,f,b)):8===a?v.push(e("b>t",d,f,c),e("b>t",d,f,b)):56===a?v.push(e("l>r",d,f,c),e("l>r",d,f,b)):24===a?v.push(e("r>l",d,f,c),e("r>l",d,f,b)):78===a?v.push(e("d-",d,f,c),e("d-",d,f,b)):2===a?v.push(e("d+",d,f,b),e("d+",d,f,c)):74===a?v.push(e("c-",d,f,c),e("c-",d,f,b)):6===a?v.push(e("c+",d,f,b),e("c+",d,f,c)):62===a?v.push(e("b-",d,f,c),e("b-",d,f,b)):18===a?v.push(e("b+",d,f,b),e("b+",d,f,c)):26===a?v.push(e("a-",d,f,c),e("a-",d,f,b)):54===a?v.push(e("a+",d,f,b),e("a+",d,f,c)):45===a?v.push(e("b+",d,f,c),e("t>b",d,f,b)):15===a?v.push(e("c+",d,f,c),e("r>l",d,f,b)):5===a?v.push(e("d+",d,f,c),e("b>t",d,f,b)):55===a?v.push(e("a+",d,f,c),e("l>r",d,f,b)):35===a?v.push(e("b-",d,f,b),e("b>t",d,f,c)):65===a?v.push(e("c-",d,f,b),e("l>r",d,f,c)):75===a?v.push(e("d-",d,f,b),e("t>b",d,f,c)):25===a?v.push(e("a-",d,f,b),e("r>l",d,f,c)):29===a?v.push(e("d+",d,f,c),e("l>r",d,f,b)):63===a?v.push(e("a+",d,f,c),e("t>b",d,f,b)):21===a?v.push(e("b+",d,f,c),e("r>l",d,f,b)):7===a?v.push(e("c+",d,f,c),e("b>t",d,f,b)):51===a?v.push(e("d-",d,f,b),e("r>l",d,f,c)):17===a?v.push(e("a-",d,f,b),e("b>t",d,f,c)):59===a?v.push(e("b-",d,f,b),e("l>r",d,f,c)):73===a?v.push(e("c-",d,f,b),e("t>b",d,f,c)):22===a?v.push(e("a-",d,f,b),e("b+",d,f,c)):66===a?v.push(e("a+",d,f,c),e("d-",d,f,b)):38===a?v.push(e("c-",d,f,b),e("d+",d,f,c)):34===a?v.push(e("b-",d,f,b),e("c+",d,f,c)):58===a?v.push(e("a+",d,f,c),e("b-",d,f,b)):14===a?v.push(e("a-",d,f,b),e("d+",d,f,c)):42===a?v.push(e("c+",d,f,c),e("d-",d,f,b)):46===a?v.push(e("b+",d,f,c),e("c-",d,f,b)):64===a?v.push(e("a+",d,f,c),e("c-",d,f,b)):16===a?v.push(e("a-",d,f,b),e("c+",d,f,c)):32===a?v.push(e("b-",d,f,b),e("d+",d,f,c)):48===a?v.push(e("b+",d,f,c),e("d-",d,f,b)):60===a?(h=g(d,f),0===h?v.push(e("a+",d,f,c),e("a+",d,f,b),e("c+",d,f,c),e("c+",d,f,b)):1===h?v.push(e("a+",d,f,c),e("b-",d,f,b),e("c+",d,f,c),e("d-",d,f,b)):2===h&&v.push(e("b-",d,f,c),e("b-",d,f,b),e("d-",d,f,c),e("d-",d,f,b))):20===a?(h=g(d,f),0===h?v.push(e("b+",d,f,c),e("b+",d,f,b),e("d+",d,f,c),e("d+",d,f,b)):1===h?v.push(e("a-",d,f,b),e("b+",d,f,c),e("c-",d,f,b),e("d+",d,f,c)):2===h&&v.push(e("a-",d,f,c),e("a-",d,f,b),e("c-",d,f,c),e("c-",d,f,b))):10===a?(h=g(d,f),0===h?v.push(e("b+",d,f,b),e("d+",d,f,b)):1===h&&v.push(e("a-",d,f,b),e("c-",d,f,b))):30===a?(h=g(d,f),0===h?v.push(e("a+",d,f,b),e("c+",d,f,b)):1===h&&v.push(e("b-",d,f,b),e("d-",d,f,b))):70===a?(h=g(d,f),1===h?v.push(e("a+",d,f,c),e("c+",d,f,c)):2===h&&v.push(e("b-",d,f,c),e("d-",d,f,c))):50===a?(h=g(d,f),1===h?v.push(e("b+",d,f,c),e("d+",d,f,c)):2===h&&v.push(e("a-",d,f,c),e("c-",d,f,c))):69===a?(h=g(d,f),0===h||1===h?v.push(e("a+",d,f,c),e("c+",d,f,c),e("d-",d,f,b)):2===h&&v.push(e("b-",d,f,c),e("d-",d,f,c),e("d-",d,f,b))):61===a?(h=g(d,f),0===h||1===h?v.push(e("a+",d,f,c),e("b-",d,f,b),e("c+",d,f,c)):2===h&&v.push(e("b-",d,f,c),e("b-",d,f,b),e("d-",d,f,c))):47===a?(h=g(d,f),0===h||1===h?v.push(e("b+",d,f,c),e("c-",d,f,b),e("d+",d,f,c)):2===h&&v.push(e("a-",d,f,c),e("c-",d,f,c),e("c-",d,f,b))):23===a?(h=g(d,f),0===h||1===h?v.push(e("a-",d,f,b),e("b+",d,f,c),e("d+",d,f,c)):2===h&&v.push(e("a-",d,f,c),e("a-",d,f,b),e("c-",d,f,c))):11===a?(h=g(d,f),0===h?v.push(e("b+",d,f,b),e("d+",d,f,c),e("d+",d,f,b)):(1===h||2===h)&&v.push(e("a-",d,f,b),e("c-",d,f,b),e("d+",d,f,c))):19===a?(h=g(d,f),0===h?v.push(e("b+",d,f,c),e("b+",d,f,b),e("d+",d,f,b)):(1===h||2===h)&&v.push(e("a-",d,f,b),e("b+",d,f,c),e("c-",d,f,b))):33===a?(h=g(d,f),0===h?v.push(e("a+",d,f,b),e("c+",d,f,c),e("c+",d,f,b)):(1===h||2===h)&&v.push(e("b-",d,f,b),e("c+",d,f,c),e("d-",d,f,b))):57===a?(h=g(d,f),0===h?v.push(e("a+",d,f,c),e("a+",d,f,b),e("c+",d,f,b)):(1===h||2===h)&&v.push(e("a+",d,f,c),e("b-",d,f,b),e("d-",d,f,b))):void 0}function k(a,d,e,f){function g(a){return"01"===a?[].concat(i(o(d,e,0,b)),[d+1,e+1]):"02"===a?[].concat(i(o(d,e,0,b)),i(o(d,e,0,c))):"10"===a?[].concat(i(o(d,e,1,b)),[d+1,e]):"11"===a?[d+1,e,d+1,e+1]:"12"===a?[].concat(i(o(d,e,0,c)),[d+1,e]):"20"===a?[].concat(i(o(d,e,1,b)),i(o(d,e,1,c))):!("21"!=a)&&[].concat(i(o(d,e,1,c)),[d+1,e+1])}function h(a){return"01"===a?[].concat(i(r(d,e,1,b)),[d,e+1]):"02"===a?[].concat(i(r(d,e,1,b)),i(r(d,e,1,c))):"10"===a?[].concat(i(r(d,e,0,b)),[d+1,e+1]):"11"===a?[d+1,e+1,d,e+1]:"12"===a?[].concat(i(r(d,e,1,c)),[d+1,e+1]):"20"===a?[].concat(i(r(d,e,0,b)),i(r(d,e,0,c))):!("21"!=a)&&[].concat(i(r(d,e,0,c)),[d,e+1])}function j(a){return"01"===a?[].concat(i(s(d,e,1,b)),[d,e]):"02"===a?[].concat(i(s(d,e,1,b)),i(s(d,e,1,c))):"10"===a?[].concat(i(s(d,e,0,b)),[d,e+1]):"11"===a?[d,e+1,d,e]:"12"===a?[].concat(i(s(d,e,1,c)),[d,e+1]):"20"===a?[].concat(i(s(d,e,0,b)),i(s(d,e,0,c))):!("21"!=a)&&[].concat(i(s(d,e,0,c)),[d,e])}function k(a){return"01"===a?[].concat(i(t(d,e,0,b)),[d+1,e]):"02"===a?[].concat(i(t(d,e,0,b)),i(t(d,e,0,c))):"10"===a?[].concat(i(t(d,e,1,b)),[d,e]):"11"===a?[d,e,d+1,e]:"12"===a?[].concat(i(t(d,e,0,c)),[d,e]):"20"===a?[].concat(i(t(d,e,1,b)),i(t(d,e,1,c))):!("21"!=a)&&[].concat(i(t(d,e,1,c)),[d+1,e])}var l;"top"===f?(l=g(a[0]+a[1]),l&&v.push(l)):"right"===f?(l=h(a[1]+a[2]),l&&v.push(l)):"bot"===f?(l=j(a[2]+a[3]),l&&v.push(l)):"left"===f?(l=k(a[3]+a[0]),l&&v.push(l)):"A"===f?(l=k(a[3]+a[0]),l&&v.push(l),l=g(a[0]+a[1]),l&&v.push(l)):"B"===f?(l=g(a[0]+a[1]),l&&v.push(l),l=h(a[1]+a[2]),l&&v.push(l)):"C"===f?(l=h(a[1]+a[2]),l&&v.push(l),l=j(a[2]+a[3]),l&&v.push(l)):"D"===f?(l=j(a[2]+a[3]),l&&v.push(l),l=k(a[3]+a[0]),l&&v.push(l)):void 0}for(var l=function(a,b,d){return a>d?(d-b)/(a-b):(d-a)/(b-a)},m=function(c,d){return a[c+1][d]||b},n=function(c,d){return a[c+1][d+1]||b},p=function(c,d){return a[c][d+1]||b},q=function(c,d){return a[c][d]||b},o=function(a,b,e,c){return[a+1,b+d(e-l(m(a,b),n(a,b),c))]},r=function(a,b,e,c){return[a+d(e-l(n(a,b),p(a,b),c)),b+1]},s=function(a,b,e,c){return[a,b+d(e-l(p(a,b),q(a,b),c))]},t=function(a,b,e,c){return[a+d(e-l(q(a,b),m(a,b),c)),b]},u=function(e,a,f,g){var d=function(a){return a<=b?"0":a>b&&a<=c?"1":"2"};return d(e)+d(a)+d(f)+d(g)},v=[],w=0,x=a.length-1;w<x;w++)for(var y=0,z=a[w].length-1;y<z;y++){var A=u(m(w,y),n(w,y),p(w,y),q(w,y)),B=parseInt(A,3);if(0!==B&&80!==B){40!==B&&h(B,w,y);var C=f(w,y);C&&k(A,w,y,C)}}return v}function y(a,b){function c(a,b,c){switch(a){case"a-":return[].concat(i(m(b,c,0)),i(p(b,c,1)));case"b-":return[].concat(i(n(b,c,1)),i(m(b,c,1)));case"c-":return[].concat(i(o(b,c,1)),i(n(b,c,0)));case"d-":return[].concat(i(p(b,c,0)),i(o(b,c,0)));case"a+":return[].concat(i(m(b,c,1)),i(p(b,c,0)));case"b+":return[].concat(i(n(b,c,0)),i(m(b,c,0)));case"c+":return[].concat(i(o(b,c,0)),i(n(b,c,1)));case"d+":return[].concat(i(p(b,c,1)),i(o(b,c,1)));case"l>r":return[].concat(i(m(b,c,1)),i(o(b,c,1)));case"r>l":return[].concat(i(m(b,c,0)),i(o(b,c,0)));case"t>b":return[].concat(i(n(b,c,0)),i(p(b,c,0)));case"b>t":return[].concat(i(n(b,c,1)),i(p(b,c,1)));default:console.error("wtf?");}}function e(a,b,d){if(0!==a&&15!==a){var e;14===a?s.push(c("d-",b,d)):1===a?s.push(c("d+",b,d)):13===a?s.push(c("c-",b,d)):2===a?s.push(c("c+",b,d)):11===a?s.push(c("b-",b,d)):4===a?s.push(c("b+",b,d)):7===a?s.push(c("a-",b,d)):8===a?s.push(c("a+",b,d)):12===a?s.push(c("t>b",b,d)):3===a?s.push(c("b>t",b,d)):9===a?s.push(c("l>r",b,d)):6===a?s.push(c("r>l",b,d)):10===a?(e=q(b,d),0===e?s.push(c("a+",b,d),c("c+",b,d)):1===e&&s.push(c("b-",b,d),c("d-",b,d))):5===a?(e=q(b,d),0===e?s.push(c("b+",b,d),c("d+",b,d)):1===e&&s.push(c("a-",b,d),c("c-",b,d))):void 0}}for(var f=function(a,c){return a>b?(b-c)/(a-c):(b-a)/(c-a)},g=function(b,c){return a[b+1][c]},h=function(b,c){return a[b+1][c+1]},k=function(b,c){return a[b][c+1]},l=function(b,c){return a[b][c]},m=function(a,b,e){return[a+1,b+d(e-f(g(a,b),h(a,b)))]},n=function(a,b,e){return[a+d(e-f(h(a,b),k(a,b))),b+1]},o=function(a,b,e){return[a,b+d(e-f(k(a,b),l(a,b)))]},p=function(a,b,e){return[a+d(e-f(l(a,b),g(a,b))),b]},q=function(a,c){return(g(a,c)+h(a,c)+k(a,c)+l(a,c))/4<=b?0:1},r=function(e,a,f,c){var d=function(a){return a<=b?"0":"1"};return parseInt(d(e)+d(a)+d(f)+d(c),2)},s=[],t=0,u=a.length-1;t<u;t++)for(var v=0,w=a[t].length-1;v<w;v++)e(r(g(t,v),h(t,v),k(t,v),l(t,v)),t,v);return s}c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c["default"]:c;var z=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"value",c=a.map(function(a){return{type:"Feature",properties:g({},b,a[2]),geometry:{type:"Point",coordinates:[a[1],a[0]]}}});return{type:"FeatureCollection",features:c}},A=function(a,d,e){var f=z(a);return{type:"FeatureCollection",features:c.voronoi(f,{bbox:d}).features.filter(function(a){a.properties.value=c.pointsWithinPolygon(f,a).features[0].properties.value;var d=b.intersection(e.geometry.coordinates,a.geometry.coordinates);return!!d&&(a.geometry.type="MultiPolygon",a.geometry.coordinates=d,a.properties.area=c.area(a),!0)})}};a.IDW=function(a,b){var c=Math.sqrt,f=Math.pow;function g(a,b){for(var c=[],d=0;d<A;d++){c[d]=[];for(var e=0;e<B;e++)c[d][e]=a(b,d,e)}return c}function h(a){return a.map(function(a){return[d(v[1]-a[0])/C,d(v[0]-a[1])/D,a[2]]})}function k(b,c,f){for(var g=e(d(y.bbox[0]-a[f][1])/y.longCellSize),h=e(d(y.bbox[1]-a[f][0])/y.latCellSize),i=e(d(y.bbox[0]-(c*D+v[0]))/y.longCellSize),j=e(d(y.bbox[1]-(b*C+v[1]))/y.latCellSize),k=l(h,g,j,i),m=0,n=0;n<k.length-1;n++)m+=d(k[n+1]-k[n]);return m}function l(a,b,c,e){for(var f=[],g=d(c-a),h=d(e-b),i=a<c?1:-1,j=b<e?1:-1,k=g-h;a!=c||b!=e;){f.push(y.grid[a][b]);var l=2*k;l>-h&&(k-=h,a+=i),l<g&&(k+=g,b+=j)}return f.push(y.grid[c][e]),f}var m,n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},q=3<arguments.length?arguments[3]:void 0,u=r(n,a),v=u.bbox,w=u.units,x=u.exponent,y=u.mask,z=p(v,b,w[0]),A=z.latSize,B=z.longSize,C=z.latCellSize,D=z.longCellSize;if("degrees"===w[1]){if(!y)m=g(function(a,b,e){for(var g,h=[b+.5,e+.5],i=0,j=0,k=0;k<a.length;k++){if(g=c(f(h[0]-a[k][0],2)+f(h[1]-a[k][1],2)),0===g)return a[k][2];var l=f(g,-x);i+=a[k][2]*l,j+=l}return i/j},h(a));else if(v[0]>=y.bbox[0]&&v[1]>=y.bbox[1]&&v[2]<=y.bbox[2]&&v[3]<=y.bbox[3])m=g(function(a,b,e){for(var g,h=[b+.5,e+.5],i=0,j=0,l=0;l<a.length;l++)if(g=c(f(h[0]-a[l][0],2)+f(h[1]-a[l][1],2)),!(q&&g>q)){if(0===g)return a[l][2];var m=k(b,e,l),n=f(g,-(x+m));i+=a[l][2]*n,j+=n}return i/j},h(a));else throw console.log(v,y.bbox),new Error("mask shoud be bigger then bbox");}else if("meters"===w[1])if(!y)m=g(function(a,b,c){for(var e,g=[v[1]+(b+.5)*C,v[0]+(c+.5)*D],h=0,i=0,j=0;j<a.length;j++){if(e=o(a[j],g),0===e)return a[j][2];var k=f(e,-x);h+=a[j][2]*k,i+=k}return h/i},a);else if(v[0]>=y.bbox[0]&&v[1]>=y.bbox[1]&&v[2]<=y.bbox[2]&&v[3]<=y.bbox[3])m=g(function(a,b,c){for(var e=[v[1]+(b+.5)*C,v[0]+(c+.5)*D],g=0,h=0,i=0;i<a.length;i++){var j=f(k(b,c,i),2),l=o(a[i],e);if(0===l)return a[i][2];var d=f(l+j,-x);g+=a[i][2]*d,h+=d}return g/h},a);else throw console.log(v,y.bbox),new Error("mask shoud be bigger then bbox");return{grid:m,latCellSize:C,longCellSize:D,bbox:v,toAsc:s,toGeoJson:t}},a.ascToArray=function(a){for(var b,c,d,e,f,g=[],h=a.split("\n"),j=0,k=h[j].split(" ");"NODATA_value"!==k[0];){switch(k[0]){case"ncols":b=+k[k.length-1];break;case"nrows":c=+k[k.length-1];break;case"xllcorner":e=+k[k.length-1];break;case"yllcorner":d=+k[k.length-1];break;case"cellsize":f=+k[k.length-1];}j++,k=h[j].split(" ")}k=h[j].split(" ");for(var l=+k[k.length-1],m=j+1;m<h.length-1;m++){g.push([]);var n=h[m].split(" ");n.forEach(function(a){""!==a&&g[g.length-1].push(+a)})}return{grid:g.reverse(),latCellSize:f,longCellSize:f,bbox:[e,d,e+b*f,d+c*f],noData:l,toGeoJson:t}},a.getTotalLevel=function(a){var b=0,c=0;return a.features.forEach(function(a){b+=a.properties.area*a.properties.value,c+=a.properties.area}),b/c},a.isobands=function(a,d,e){var f={type:"FeatureCollection",features:[]},g=[],h=[],l=d[0]-100,m=d[0];g.push(u(x(a.grid,l,m))),h.push("<"+d[0]);for(var n=0;n<d.length-1;n++)l=d[n],m=d[n+1],g.push(u(x(a.grid,l,m))),h.push(l+"-"+m);l=d[d.length-1],m=1/0,g.push(u(x(a.grid,l,m))),h.push(d[d.length-1]+"<");for(var o=[],p=0;p<g.length;p++){o.push([]);for(var q=0;q<g[p].length;q++){o[p].push([]);for(var r=0;r<g[p][q].length;r++)o[p][q].push([g[p][q][r][1]*a.longCellSize+a.bbox[0],g[p][q][r][0]*a.latCellSize+a.bbox[1]])}}if(e){for(var s,t=0;t<o.length;t++)if(s=v(o[t]),s.length){var w=b.intersection(e.geometry.coordinates,s)||[];f.features.push({type:"Feature",properties:{value:h[t]},geometry:{type:"MultiPolygon",coordinates:w}})}f.features.forEach(function(a){a.properties.area=c.area(a)})}else for(var y=0;y<o.length;y++)f.features.push({type:"Feature",properties:{value:h[y]},geometry:{type:"MultiPolygon",coordinates:v(o[y])}});return f},a.isolines=function(a,b){for(var c,d=[],e=[],f={type:"FeatureCollection",features:[]},g=0;g<b.length;g++)c=b[g],d.push(u(y(a.grid,c))),e.push(c);for(var l=0;l<d.length;l++)for(var m=0;m<d[l].length;m++){for(var n,o=0;o<d[l][m].length;o++)n=d[l][m][o][0]*a.latCellSize+a.bbox[1],d[l][m][o][0]=d[l][m][o][1]*a.longCellSize+a.bbox[0],d[l][m][o][1]=n;f.features.push({type:"Feature",properties:{value:e[l]},geometry:{type:"LineString",coordinates:d[l][m]}})}return f},a.pointGridToArray=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"value",c=[a.features[0].geometry.coordinates[0],a.features[0].geometry.coordinates[1]];if(a.features[1].geometry.coordinates[0]===c[0]){for(var d,f,g=a.features[1].geometry.coordinates[1]-c[1],h=1;h<a.features.length;h++)if(a.features[h].geometry.coordinates[1]===c[1]){d=a.features[h].geometry.coordinates[0]-c[0],f=h;break}var j=a.features.length/f;c.push(c[0]+j*d,c[1]+f*g);var k=[];return a.features.forEach(function(a,c){var d=e(c/f),g=c-d*f;k[g]||(k[g]=[]),k[g][d]=a.properties[[b]]}),{grid:k,latCellSize:g,longCellSize:d,bbox:c,toAsc:s}}for(var l,m,n=a.features[1].geometry.coordinates[0]-c[0],o=1;o<a.features.length;o++)if(a.features[o].geometry.coordinates[0]===c[0]){l=a.features[o].geometry.coordinates[1]-c[1],m=o;break}var p=a.features.length/m;c.push(c[0]+m*n,c[1]+p*l);var q=[];return a.features.forEach(function(a,c){var d=e(c/m),f=c-d*m;q[d]||(q[d]=[]),q[d][f]=a.properties[[b]]}),{grid:q,latCellSize:l,longCellSize:n,bbox:c,toAsc:s}},a.pointsToArray=function(a){var b=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"value";return a.features.map(function(a){return[].concat(i(a.geometry.coordinates.reverse()),[a.properties[[b]]])})},a.pointsToGeoJson=z,a.voronoi=A,Object.defineProperty(a,"__esModule",{value:!0})});
