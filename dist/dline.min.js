(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):(a=a||self,b(a.dline={}))})(this,function(a){'use strict';var A=Math.ceil,B=Math.max,C=Math.min,D=Math.pow,E=Math.floor,F=Math.acos,G=Math.cos,H=Math.sin,I=Math.abs,J=Math.PI;function b(a,b,c,e){var f=a[0]*J/180,g=b[0]*J/180,h=a[1]*J/180,i=b[1]*J/180,j="Long"===e?I(a[1]-b[1]):"Lat"===e?I(a[0]-b[0]):NaN,d=6372795*F(H(f)*H(g)+G(f)*G(g)*G(h-i));return j*c/d}function c(a,b,c,d,e,f,g){for(var h=Array(b),l=0;l<b;l++)h[l]=Array(c);for(var m,n,o=[],p=0;p<a.length;p++)m=I(g-a[p][1])/e,n=I(f-a[p][0])/d,h[E(n)][E(m)]=a[p][2],o.push([E(n),E(m),a[p][2]]);for(var q=0,r=0,s=0;s<b;s++)for(var t=0;t<c;t++)if(null==h[s][t]){for(var u=0;u<o.length;u++)q+=o[u][2]*(1/D(D(s-o[u][0],2)+D(t-o[u][1],2),2)),r+=1/D(D(s-o[u][0],2)+D(t-o[u][1],2),2);h[s][t]=q/r,q=0,r=0}return h}function d(a,d,e){var f=C.apply(null,a.map(function(a){return a[2]})),g=B.apply(null,a.map(function(a){return a[2]})),h=d[2]-d[0],i=d[3]-d[1],j=b([d[1],d[0]],[d[1],d[2]],e,"Long"),k=b([d[1],d[0]],[d[3],d[0]],e,"Lat"),l=A(h/j),m=A(i/k),n=c(a,m,l,k,j,d[1],d[0]);return{Grid:n,DeltaLat:k,DeltaLong:j,Grid_Min_Lat:d[1],Grid_Min_Long:d[0],Dot_Max_Z:g,Dot_Min_Z:f}}function e(a){for(var b=[],c=!0;0<a.length;){!0===c&&(b.push([]),b[b.length-1].push([a[0][0],a[0][1]],[a[0][2],a[0][3]]),a.splice(0,1)),c=!0;for(var d=0,e=a.length;d<e;d++){if(b[b.length-1][b[b.length-1].length-1][0]===a[d][0]&&b[b.length-1][b[b.length-1].length-1][1]===a[d][1]){b[b.length-1].push([a[d][2],a[d][3]]),a.splice(d,1),c=!1;break}else if(b[b.length-1][b[b.length-1].length-1][0]===a[d][2]&&b[b.length-1][b[b.length-1].length-1][1]===a[d][3]){b[b.length-1].push([a[d][0],a[d][1]]),a.splice(d,1),c=!1;break}if(b[b.length-1][0][0]===a[d][0]&&b[b.length-1][0][1]===a[d][1]){b[b.length-1].unshift([a[d][2],a[d][3]]),a.splice(d,1),c=!1;break}else if(b[b.length-1][0][0]===a[d][2]&&b[b.length-1][0][1]===a[d][3]){b[b.length-1].unshift([a[d][0],a[d][1]]),a.splice(d,1),c=!1;break}}}return b}function f(a){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},f(a)}function g(a){return h(a)||i(a)||j()}function h(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}}function i(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)}function j(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function k(a,b,d){for(var e=d.length,f=e-1,g=!1,h=0;h<e;h++)(d[h][0]<=b&&b<d[f][0]||d[f][0]<=b&&b<d[h][0])&&a>(d[f][1]-d[h][1])*(b-d[h][0])/(d[f][0]-d[h][0])+d[h][1]&&(g=!g),f=h;return g}function l(a){var b=g(a);b.sort(function(c,a){return c.length-a.length}).reverse();for(var c,d={},e=0;e<b.length;e++){c=[];for(var f=0;f<b.length;f++)e!==f&&k(b[e][0][1],b[e][0][0],b[f])&&c.push(f);d[[e]]=c}for(var h,l=[],m=0;m<b.length;m++){for(var n in h=[],d)d[n][d[n].length-1]===m&&0==(d[n].length-1)%2&&h.push(b[n]);0!=(d[[m]].length-1)%2&&l.push([b[m]].concat(h))}return l}function m(a,b,c){function d(a,b,c){for(var d=c.toString().includes(".")?c.toString().split(".").pop().length:0,e=[],f=a;f>=b;)e.push(f),f-=c,f=parseFloat(f.toFixed(d));return e}switch(a.type){case"CustomValues":return a.values;case"Range":return d(a.max,a.min,a.step);case"FullRange":return d(b,c,a.step);}}function n(a,b,c){function d(a,b,c,d){switch(a){case"a-":return[].concat(g(q(b,c,0,d)),g(t(b,c,1,d)));case"b-":return[].concat(g(r(b,c,1,d)),g(q(b,c,1,d)));case"c-":return[].concat(g(s(b,c,1,d)),g(r(b,c,0,d)));case"d-":return[].concat(g(t(b,c,0,d)),g(s(b,c,0,d)));case"a+":return[].concat(g(q(b,c,1,d)),g(t(b,c,0,d)));case"b+":return[].concat(g(r(b,c,0,d)),g(q(b,c,0,d)));case"c+":return[].concat(g(s(b,c,0,d)),g(r(b,c,1,d)));case"d+":return[].concat(g(t(b,c,1,d)),g(s(b,c,1,d)));case"l>r":return[].concat(g(q(b,c,1,d)),g(s(b,c,1,d)));case"r>l":return[].concat(g(q(b,c,0,d)),g(s(b,c,0,d)));case"t>b":return[].concat(g(r(b,c,0,d)),g(t(b,c,0,d)));case"b>t":return[].concat(g(r(b,c,1,d)),g(t(b,c,1,d)));default:throw new Error("imposible");}}function e(b,c){if(0!==b&&0!==c&&b!==a.length-2&&c!==a[b].length-2)return 0;if(b===a.length-2&&0!==c&&c!==a[b].length-2)return"top";if(b!==a.length-2&&0!==b&&c===a[b].length-2)return"right";if(0===b&&c!==a[b].length-2&&0!==c)return"bot";if(b!==a.length-2&&0===c&&0!==b)return"left";if(b===a.length-2&&0===c)return"A";if(b===a.length-2&&c===a[b].length-2)return"B";if(0===b&&c===a[b].length-2)return"C";if(0===b&&0===c)return"D";throw new Error("invalid x or y")}function f(a,d){var e=(m(a,d)+n(a,d)+o(a,d)+p(a,d))/4;return e<=b?0:e>b&&e<=c?1:2}function h(a,e,g){var h;"2221"===a?v.push(d("d-",e,g,c)):"1112"===a?v.push(d("d+",e,g,c)):"0001"===a?v.push(d("d+",e,g,b)):"1110"===a?v.push(d("d-",e,g,b)):"2212"===a?v.push(d("c-",e,g,c)):"1121"===a?v.push(d("c+",e,g,c)):"0010"===a?v.push(d("c+",e,g,b)):"1101"===a?v.push(d("c-",e,g,b)):"2122"===a?v.push(d("b-",e,g,c)):"1211"===a?v.push(d("b+",e,g,c)):"0100"===a?v.push(d("b+",e,g,b)):"1011"===a?v.push(d("b-",e,g,b)):"1222"===a?v.push(d("a-",e,g,c)):"2111"===a?v.push(d("a+",e,g,c)):"1000"===a?v.push(d("a+",e,g,b)):"0111"===a?v.push(d("a-",e,g,b)):"0011"===a?v.push(d("b>t",e,g,b)):"1100"===a?v.push(d("t>b",e,g,b)):"2211"===a?v.push(d("t>b",e,g,c)):"1122"===a?v.push(d("b>t",e,g,c)):"0110"===a?v.push(d("r>l",e,g,b)):"1001"===a?v.push(d("l>r",e,g,b)):"2112"===a?v.push(d("l>r",e,g,c)):"1221"===a?v.push(d("r>l",e,g,c)):"2200"===a?v.push(d("t>b",e,g,c),d("t>b",e,g,b)):"0022"===a?v.push(d("b>t",e,g,c),d("b>t",e,g,b)):"2002"===a?v.push(d("l>r",e,g,c),d("l>r",e,g,b)):"0220"===a?v.push(d("r>l",e,g,c),d("r>l",e,g,b)):"2220"===a?v.push(d("d-",e,g,c),d("d-",e,g,b)):"0002"===a?v.push(d("d+",e,g,b),d("d+",e,g,c)):"2202"===a?v.push(d("c-",e,g,c),d("c-",e,g,b)):"0020"===a?v.push(d("c+",e,g,b),d("c+",e,g,c)):"2022"===a?v.push(d("b-",e,g,c),d("b-",e,g,b)):"0200"===a?v.push(d("b+",e,g,b),d("b+",e,g,c)):"0222"===a?v.push(d("a-",e,g,c),d("a-",e,g,b)):"2000"===a?v.push(d("a+",e,g,b),d("a+",e,g,c)):"1200"===a?v.push(d("b+",e,g,c),d("t>b",e,g,b)):"0120"===a?v.push(d("c+",e,g,c),d("r>l",e,g,b)):"0012"===a?v.push(d("d+",e,g,c),d("b>t",e,g,b)):"2001"===a?v.push(d("a+",e,g,c),d("l>r",e,g,b)):"1022"===a?v.push(d("b-",e,g,b),d("b>t",e,g,c)):"2102"===a?v.push(d("c-",e,g,b),d("l>r",e,g,c)):"2210"===a?v.push(d("d-",e,g,b),d("t>b",e,g,c)):"0221"===a?v.push(d("a-",e,g,b),d("r>l",e,g,c)):"1002"===a?v.push(d("d+",e,g,c),d("l>r",e,g,b)):"2100"===a?v.push(d("a+",e,g,c),d("t>b",e,g,b)):"0210"===a?v.push(d("b+",e,g,c),d("r>l",e,g,b)):"0021"===a?v.push(d("c+",e,g,c),d("b>t",e,g,b)):"1220"===a?v.push(d("d-",e,g,b),d("r>l",e,g,c)):"0122"===a?v.push(d("a-",e,g,b),d("b>t",e,g,c)):"2012"===a?v.push(d("b-",e,g,b),d("l>r",e,g,c)):"2201"===a?v.push(d("c-",e,g,b),d("t>b",e,g,c)):"0211"===a?v.push(d("a-",e,g,b),d("b+",e,g,c)):"2110"===a?v.push(d("a+",e,g,c),d("d-",e,g,b)):"1102"===a?v.push(d("c-",e,g,b),d("d+",e,g,c)):"1021"===a?v.push(d("b-",e,g,b),d("c+",e,g,c)):"2011"===a?v.push(d("a+",e,g,c),d("b-",e,g,b)):"0112"===a?v.push(d("a-",e,g,b),d("d+",e,g,c)):"1120"===a?v.push(d("c+",e,g,c),d("d-",e,g,b)):"1201"===a?v.push(d("b+",e,g,c),d("c-",e,g,b)):"2101"===a?v.push(d("a+",e,g,c),d("c-",e,g,b)):"0121"===a?v.push(d("a-",e,g,b),d("c+",e,g,c)):"1012"===a?v.push(d("b-",e,g,b),d("d+",e,g,c)):"1210"===a?v.push(d("b+",e,g,c),d("d-",e,g,b)):"2020"===a?(h=f(e,g),0===h?v.push(d("a+",e,g,c),d("a+",e,g,b),d("c+",e,g,c),d("c+",e,g,b)):1===h?v.push(d("a+",e,g,c),d("b-",e,g,b),d("c+",e,g,c),d("d-",e,g,b)):2===h&&v.push(d("b-",e,g,c),d("b-",e,g,b),d("d-",e,g,c),d("d-",e,g,b))):"0202"===a?(h=f(e,g),0===h?v.push(d("b+",e,g,c),d("b+",e,g,b),d("d+",e,g,c),d("d+",e,g,b)):1===h?v.push(d("a-",e,g,b),d("b+",e,g,c),d("c-",e,g,b),d("d+",e,g,c)):2===h&&v.push(d("a-",e,g,c),d("a-",e,g,b),d("c-",e,g,c),d("c-",e,g,b))):"0101"===a?(h=f(e,g),0===h?v.push(d("b+",e,g,b),d("d+",e,g,b)):1===h&&v.push(d("a-",e,g,b),d("c-",e,g,b))):"1010"===a?(h=f(e,g),0===h?v.push(d("a+",e,g,b),d("c+",e,g,b)):1===h&&v.push(d("b-",e,g,b),d("d-",e,g,b))):"2121"===a?(h=f(e,g),1===h?v.push(d("a+",e,g,c),d("c+",e,g,c)):2===h&&v.push(d("b-",e,g,c),d("d-",e,g,c))):"1212"===a?(h=f(e,g),1===h?v.push(d("b+",e,g,c),d("d+",e,g,c)):2===h&&v.push(d("a-",e,g,c),d("c-",e,g,c))):"2120"===a?(h=f(e,g),1===h?v.push(d("a+",e,g,c),d("c+",e,g,c),d("d-",e,g,b)):2===h&&v.push(d("b-",e,g,c),d("d-",e,g,c),d("d-",e,g,b))):"2021"===a?(h=f(e,g),1===h?v.push(d("a+",e,g,c),d("b-",e,g,b),d("c+",e,g,c)):2===h&&v.push(d("b-",e,g,c),d("b-",e,g,b),d("d-",e,g,c))):"1202"===a?(h=f(e,g),1===h?v.push(d("b+",e,g,c),d("c-",e,g,b),d("d+",e,g,c)):2===h&&v.push(d("a-",e,g,c),d("c-",e,g,c),d("c-",e,g,b))):"0212"===a?(h=f(e,g),1===h?v.push(d("a-",e,g,b),d("b+",e,g,c),d("d+",e,g,c)):2===h&&v.push(d("a-",e,g,c),d("a-",e,g,b),d("c-",e,g,c))):"0102"===a?(h=f(e,g),0===h?v.push(d("b+",e,g,b),d("d+",e,g,c),d("d+",e,g,b)):1===h&&v.push(d("a-",e,g,b),d("c-",e,g,b),d("d+",e,g,c))):"0201"===a?(h=f(e,g),0===h?v.push(d("b+",e,g,c),d("b+",e,g,b),d("d+",e,g,b)):1===h&&v.push(d("a-",e,g,b),d("b+",e,g,c),d("c-",e,g,b))):"1020"===a?(h=f(e,g),0===h?v.push(d("a+",e,g,b),d("c+",e,g,c),d("c+",e,g,b)):1===h&&v.push(d("b-",e,g,b),d("c+",e,g,c),d("d-",e,g,b))):"2010"===a?(h=f(e,g),0===h?v.push(d("a+",e,g,c),d("a+",e,g,b),d("c+",e,g,b)):1===h&&v.push(d("a+",e,g,c),d("b-",e,g,b),d("d-",e,g,b))):void 0}function k(a,d,e,f){function h(a){return"01"===a?[].concat(g(q(d,e,0,b)),[d+1,e+1]):"02"===a?[].concat(g(q(d,e,0,b)),g(q(d,e,0,c))):"10"===a?[].concat(g(q(d,e,1,b)),[d+1,e]):"11"===a?[d+1,e,d+1,e+1]:"12"===a?[].concat(g(q(d,e,0,c)),[d+1,e]):"20"===a?[].concat(g(q(d,e,1,b)),g(q(d,e,1,c))):!("21"!=a)&&[].concat(g(q(d,e,1,c)),[d+1,e+1])}function i(a){return"01"===a?[].concat(g(r(d,e,1,b)),[d,e+1]):"02"===a?[].concat(g(r(d,e,1,b)),g(r(d,e,1,c))):"10"===a?[].concat(g(r(d,e,0,b)),[d+1,e+1]):"11"===a?[d+1,e+1,d,e+1]:"12"===a?[].concat(g(r(d,e,1,c)),[d+1,e+1]):"20"===a?[].concat(g(r(d,e,0,b)),g(r(d,e,0,c))):!("21"!=a)&&[].concat(g(r(d,e,0,c)),[d,e+1])}function j(a){return"01"===a?[].concat(g(s(d,e,1,b)),[d,e]):"02"===a?[].concat(g(s(d,e,1,b)),g(s(d,e,1,c))):"10"===a?[].concat(g(s(d,e,0,b)),[d,e+1]):"11"===a?[d,e+1,d,e]:"12"===a?[].concat(g(s(d,e,1,c)),[d,e+1]):"20"===a?[].concat(g(s(d,e,0,b)),g(s(d,e,0,c))):!("21"!=a)&&[].concat(g(s(d,e,0,c)),[d,e])}function k(a){return"01"===a?[].concat(g(t(d,e,0,b)),[d+1,e]):"02"===a?[].concat(g(t(d,e,0,b)),g(t(d,e,0,c))):"10"===a?[].concat(g(t(d,e,1,b)),[d,e]):"11"===a?[d,e,d+1,e]:"12"===a?[].concat(g(t(d,e,0,c)),[d,e]):"20"===a?[].concat(g(t(d,e,1,b)),g(t(d,e,1,c))):!("21"!=a)&&[].concat(g(t(d,e,1,c)),[d+1,e])}var l;"top"===f?(l=h(a[0]+a[1]),l&&v.push(l)):"right"===f?(l=i(a[1]+a[2]),l&&v.push(l)):"bot"===f?(l=j(a[2]+a[3]),l&&v.push(l)):"left"===f?(l=k(a[3]+a[0]),l&&v.push(l)):"A"===f?(l=k(a[3]+a[0]),l&&v.push(l),l=h(a[0]+a[1]),l&&v.push(l)):"B"===f?(l=h(a[0]+a[1]),l&&v.push(l),l=i(a[1]+a[2]),l&&v.push(l)):"C"===f?(l=i(a[1]+a[2]),l&&v.push(l),l=j(a[2]+a[3]),l&&v.push(l)):"D"===f?(l=j(a[2]+a[3]),l&&v.push(l),l=k(a[3]+a[0]),l&&v.push(l)):void 0}for(var l=function(a,b,d){return a>d?(d+1e-4-b)/(a-b):(d+1e-4-a)/(b-a)},m=function(b,c){return a[b+1][c]},n=function(b,c){return a[b+1][c+1]},o=function(b,c){return a[b][c+1]},p=function(b,c){return a[b][c]},q=function(a,b,d,c){return[a+1,b+I(d-l(m(a,b),n(a,b),c))]},r=function(a,b,d,c){return[a+I(d-l(n(a,b),o(a,b),c)),b+1]},s=function(a,b,d,c){return[a,b+I(d-l(o(a,b),p(a,b),c))]},t=function(a,b,d,c){return[a+I(d-l(p(a,b),m(a,b),c)),b]},u=function(e,a,f,g){var d=function(a){return a<=b||Number.isNaN(a)?"0":a>b&&a<=c?"1":"2"};return d(e)+d(a)+d(f)+d(g)},v=[],w=0,x=a.length-1;w<x;w++)for(var y,z=0,A=a[w].length-1;z<A;z++)if(y=u(m(w,z),n(w,z),o(w,z),p(w,z)),"0000"!==y&&"2222"!==y){"1111"!==y&&h(y,w,z);var B=e(w,z);B&&k(y,w,z,B)}return v}function o(a,b,c,d,f,g,h,o){var p={type:"FeatureCollection",features:[]},q=[],r=[],s=m(b,h,o),t=s[0],u=1/0;q.push(e(n(a,t,u))),r.push("more than "+s[0]);for(var v=0;v<s.length-1;v++)t=s[v+1],u=s[v],q.push(e(n(a,t,u))),r.push(u);t=-Infinity,u=s[s.length-1],q.push(e(n(a,t,u))),r.push("less than "+s[s.length-1]);for(var w=[],x=1/0,y=-Infinity,z=1/0,A=-Infinity,B=0;B<q.length;B++){w.push([]);for(var C=0;C<q[B].length;C++){w[B].push([]);for(var D=0;D<q[B][C].length;D++){if(0<D&&D<q[B][C].length-1&&(q[B][C][D][0]===q[B][C][D+1][0]&&q[B][C][D][0]===q[B][C][D-1][0]||q[B][C][D][1]===q[B][C][D+1][1]&&q[B][C][D][1]===q[B][C][D-1][1])){q[B][C][D][0]<x&&(x=q[B][C][D][0]),q[B][C][D][0]>y&&(y=q[B][C][D][0]),q[B][C][D][1]<z&&(z=q[B][C][D][1]),q[B][C][D][1]>A&&(A=q[B][C][D][1]);continue}w[B][C].push([q[B][C][D][1]*d+g,q[B][C][D][0]*c+f])}}}for(var E=0;E<w.length;E++)p.features.push({type:"Feature",properties:{value:r[E]},geometry:{type:"MultiPolygon",coordinates:l(w[E])}});return p}function p(a,d,e){var f=C.apply(Math,g(a.map(function(a){return a[0]}))),h=B.apply(null,a.map(function(a){return a[0]})),i=C.apply(null,a.map(function(a){return a[1]})),j=B.apply(null,a.map(function(a){return a[1]})),k=C.apply(null,a.map(function(a){return a[2]})),l=B.apply(null,a.map(function(a){return a[2]})),m=j-i,n=h-f,o=m*(100+e)/100,p=n*(100+e)/100,q=i-(o-m)/2,r=f-(p-n)/2,s=j+(o-m)/2,t=h+(p-n)/2,u=b([r,q],[r,s],d,"Long"),v=b([r,q],[t,q],d,"Lat"),w=A(o/u),x=A(p/v),y=c(a,x,w,v,u,r,q);return{Grid:y,DeltaLat:v,DeltaLong:u,Grid_Min_Lat:r,Grid_Min_Long:q,Grid_Max_Lat:t,Grid_Max_Long:s,Dot_Max_Z:l,Dot_Min_Z:k}}function q(a,b){function c(a,b,c){switch(a){case"a-":return[].concat(g(m(b,c,0)),g(p(b,c,1)));case"b-":return[].concat(g(n(b,c,1)),g(m(b,c,1)));case"c-":return[].concat(g(o(b,c,1)),g(n(b,c,0)));case"d-":return[].concat(g(p(b,c,0)),g(o(b,c,0)));case"a+":return[].concat(g(m(b,c,1)),g(p(b,c,0)));case"b+":return[].concat(g(n(b,c,0)),g(m(b,c,0)));case"c+":return[].concat(g(o(b,c,0)),g(n(b,c,1)));case"d+":return[].concat(g(p(b,c,1)),g(o(b,c,1)));case"l>r":return[].concat(g(m(b,c,1)),g(o(b,c,1)));case"r>l":return[].concat(g(m(b,c,0)),g(o(b,c,0)));case"t>b":return[].concat(g(n(b,c,0)),g(p(b,c,0)));case"b>t":return[].concat(g(n(b,c,1)),g(p(b,c,1)));default:console.error("wtf?");}}function d(a,b,d){if("0000"!==a&&"1111"!==a){var e;"1110"===a?s.push(c("d-",b,d)):"0001"===a?s.push(c("d+",b,d)):"1101"===a?s.push(c("c-",b,d)):"0010"===a?s.push(c("c+",b,d)):"1011"===a?s.push(c("b-",b,d)):"0100"===a?s.push(c("b+",b,d)):"0111"===a?s.push(c("a-",b,d)):"1000"===a?s.push(c("a+",b,d)):"1100"===a?s.push(c("t>b",b,d)):"0011"===a?s.push(c("b>t",b,d)):"1001"===a?s.push(c("l>r",b,d)):"0110"===a?s.push(c("r>l",b,d)):"1010"===a?(e=q(b,d),0===e?s.push(c("a+",b,d),c("c+",b,d)):1===e&&s.push(c("b-",b,d),c("d-",b,d))):"0101"===a?(e=q(b,d),0===e?s.push(c("b+",b,d),c("d+",b,d)):1===e&&s.push(c("a-",b,d),c("c-",b,d))):void 0}}for(var e=function(a,c){return a>b?(b-c)/(a-c):(b-a)/(c-a)},f=function(b,c){return a[b+1][c]},h=function(b,c){return a[b+1][c+1]},k=function(b,c){return a[b][c+1]},l=function(b,c){return a[b][c]},m=function(a,b,d){return[a+1,b+I(d-e(f(a,b),h(a,b)))]},n=function(a,b,d){return[a+I(d-e(h(a,b),k(a,b))),b+1]},o=function(a,b,d){return[a,b+I(d-e(k(a,b),l(a,b)))]},p=function(a,b,d){return[a+I(d-e(l(a,b),f(a,b))),b]},q=function(a,c){return(f(a,c)+h(a,c)+k(a,c)+l(a,c))/4<=b?0:1},r=function(e,a,f,c){var d=function(a){return a<=b?"0":"1"};return d(e)+d(a)+d(f)+d(c)},s=[],t=0,u=a.length-1;t<u;t++)for(var v=0,w=a[t].length-1;v<w;v++)d(r(f(t,v),h(t,v),k(t,v),l(t,v)),t,v);return s}function r(a,b,c,d,f,g,l,n){for(var o,p=[],r=[],s={type:"FeatureCollection",features:[]},t=m(b,l,n),u=0;u<t.length;u++)o=t[u],p.push(e(q(a,o))),r.push(o);for(var v,w=0;w<p.length;w++)for(var x=0;x<p[w].length;x++){for(var y=0;y<p[w][x].length;y++)v=p[w][x][y][0]*c+f,p[w][x][y][0]=p[w][x][y][1]*d+g,p[w][x][y][1]=v;s.features.push({type:"Feature",properties:{value:r[w]},geometry:{type:"LineString",coordinates:p[w][x]}})}return s}function s(a,b){var c=function(a){return a.map(function(a){return a*J/180})},d=c(a),e=c(b);return 6372795*F(H(d[0])*H(e[0])+G(d[0])*G(e[0])*G(d[1]-e[1]))}function t(a,b,c){function d(a){var b=A(a);return b%2?b:E(a)}if("meters"===c){var e=[a[3],a[0]],f=[a[1],a[0]],h=s(f,e),i=d(h/b),j=I(a[1]-a[3])*b/h,k=[a[1],a[0]],l=[a[1],a[2]],m=s(l,k),n=d(m/b),o=I(a[0]-a[2])*b/m;return{latSize:i,longSize:n,degreeLatCellSize:j,degreeLongCellSize:o}}if("degrees"===c){var p;if(!Array.isArray(b))p=[b,b];else if(1===b.length)p=[b[0],b[0]];else if(2===b.length)p=g(b);else throw new Error("\u0442\u0430\u043A \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C");var q=I(a[1]-a[3]),r=d(q/p[0]),t=I(a[0]-a[2]),u=d(t/p[1]);return{latSize:r,longSize:u,degreeLatCellSize:p[0],degreeLongCellSize:p[1]}}throw new Error("wtf")}function u(a,b){var c=a.bbox,d=a.units,e=a.exponent,g=a.barriers;switch(f(c)){case"undefined":c=v([0,0],b);break;case"object":if(!Array.isArray(c))throw new Error("bbox \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0430\u0441\u0441\u0438\u0432\u043E\u043C");if(0===c.length)c=v([0,0],b);else if(2===c.length)c.forEach(function(a){if("number"!=typeof a||0>a)throw new Error("\u041D\u0435\u043A\u043A\u043E\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F bbox")}),c=v(c,b);else if(4===c.length)c.forEach(function(a){if("number"!=typeof a)throw new Error("\u041D\u0435\u043A\u043A\u043E\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F bbox")});else throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E\u0435 \u043A\u043E\u043B-\u0432\u043E \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432 \u043C\u0430\u0441\u0441\u0438\u0432\u0430 bbox");break;default:throw new Error("bbox \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0430\u0441\u0441\u0438\u0432\u043E\u043C");}switch(f(d)){case"string":case"undefined":if("meters"===d||void 0===d)d=["meters","meters"];else if("degrees"===d)d=["degrees","degrees"];else throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F units");break;case"object":if(!Array.isArray(d))throw new Error("units \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0430\u0441\u0441\u0438\u0432\u043E\u043C");if(2===d.length)d.forEach(function(a){if("meters"!==a&&"degrees"!==a)throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F units")});else throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E\u0435 \u043A\u043E\u043B-\u0432\u043E \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432 \u043C\u0430\u0441\u0441\u0438\u0432\u0430 units");break;default:throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F units");}if(void 0===e)e=2;else if("number"!=typeof e||0>=e)throw new Error("\u041D\u0435\u043A\u043A\u043E\u0440\u0435\u043A\u0442\u043D\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 exponent");return g&&(g=g.features.map(function(a){return{coordinates:a.geometry.coordinates,left:a.properties.left,right:a.properties.right}})),{bbox:c,units:d,exponent:e,barriers:g}}function v(a,b){if(!Array.isArray(a))throw new Error("percents \u043D\u0435 \u041C\u0430\u0441\u0441\u0438\u0432");var c=C.apply(Math,g(b.map(function(a){return a[0]}))),d=C.apply(Math,g(b.map(function(a){return a[1]}))),e=B.apply(Math,g(b.map(function(a){return a[0]}))),f=B.apply(Math,g(b.map(function(a){return a[1]}))),h=f-d,i=e-c,j=h*(100+a[0])/100,k=i*(100+a[1])/100;return[d-(j-h)/2,c-(k-i)/2,f+(j-h)/2,e+(k-i)/2]}function w(c,d){function e(d,a){var b=!1,e=!1,f=g(a[0],a[1]),i=g(a[0],d[0]),j=g(a[0],d[1]),k=h(f,i),l=h(f,j);return 0>k*l&&(b=!0),f=g(d[0],d[1]),i=g(d[0],a[0]),j=g(d[0],a[1]),k=h(f,i),l=h(f,j),0>k*l&&(e=!0),!!(b&&e)&&(0>l?c.left:c.left)}for(var f,g=function(a,b){return[b[0]-a[0],b[1]-a[1]]},h=function(a,b){return a[0]*b[1]-b[0]*a[1]},j=[],k=0;k<c.coordinates.length-1;k++)f=e([c.coordinates[k],c.coordinates[k+1]],d),f&&j.push(f);return!!(j.length%2)&&j[0]}function x(a,b){var c=a.bbox,d=a.units,e=a.exponent,g=a.mask,h=a.buf,i=a.weightUp,j=a.weightDown;switch(f(c)){case"undefined":c=y([0,0],b);break;case"object":if(!Array.isArray(c))throw new Error("bbox \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0430\u0441\u0441\u0438\u0432\u043E\u043C");if(0===c.length)c=y([0,0],b);else if(2===c.length)c.forEach(function(a){if("number"!=typeof a||0>a)throw new Error("\u041D\u0435\u043A\u043A\u043E\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F bbox")}),c=y(c,b);else if(4===c.length)c.forEach(function(a){if("number"!=typeof a)throw new Error("\u041D\u0435\u043A\u043A\u043E\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F bbox")});else throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E\u0435 \u043A\u043E\u043B-\u0432\u043E \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432 \u043C\u0430\u0441\u0441\u0438\u0432\u0430 bbox");break;default:throw new Error("bbox \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0430\u0441\u0441\u0438\u0432\u043E\u043C");}switch(f(d)){case"string":case"undefined":if("meters"===d||d===void 0)d=["meters","meters"];else if("degrees"===d)d=["degrees","degrees"];else throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F units");break;case"object":if(!Array.isArray(d))throw new Error("units \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F \u043C\u0430\u0441\u0441\u0438\u0432\u043E\u043C");if(2===d.length)d.forEach(function(a){if("meters"!==a&&"degrees"!==a)throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F units")});else throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u043E\u0435 \u043A\u043E\u043B-\u0432\u043E \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432 \u043C\u0430\u0441\u0441\u0438\u0432\u0430 units");break;default:throw new Error("\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F units");}if(e===void 0)e=2;else if("number"!=typeof e||0>=e)throw new Error("\u041D\u0435\u043A\u043A\u043E\u0440\u0435\u043A\u0442\u043D\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 exponent");if(!g)throw new Error("err");return{bbox:c,units:d,exponent:e,mask:g,buf:h,weightUp:i,weightDown:j}}function y(a,b){if(!Array.isArray(a))throw new Error("percents \u043D\u0435 \u041C\u0430\u0441\u0441\u0438\u0432");var c=C.apply(Math,g(b.map(function(a){return a[0]}))),d=C.apply(Math,g(b.map(function(a){return a[1]}))),e=B.apply(Math,g(b.map(function(a){return a[0]}))),f=B.apply(Math,g(b.map(function(a){return a[1]}))),h=f-d,i=e-c,j=h*(100+a[0])/100,k=i*(100+a[1])/100;return[d-(j-h)/2,c-(k-i)/2,f+(j-h)/2,e+(k-i)/2]}function z(a,b,c,d,e){for(var f=[],g=I(c-a),h=I(d-b),i=a<c?1:-1,j=b<d?1:-1,k=g-h;a!=c||b!=d;){f.push(e[a][b]);var l=2*k;l>-h&&(k-=h,a+=i),l<g&&(k+=g,b+=j)}return f.push(e[c][d]),f}a.DrawGridWithExtrs=d,a.DrawIsobandsWithCustomGrid=function(a,b,c,d,e,f,g,h){return o(a,b,c,d,e,f,h,g)},a.DrawIsobandsWithExtrs=function(a,b,c,e){var f=d(a,e,c);return o(f.Grid,b,f.DeltaLat,f.DeltaLong,f.Grid_Min_Lat,f.Grid_Min_Long,f.Dot_Max_Z,f.Dot_Min_Z)},a.DrawIsobandsWithoutExtrs=function(a,b,c,d){var e=p(a,c,d),f=o(e.Grid,b,e.DeltaLat,e.DeltaLong,e.Grid_Min_Lat,e.Grid_Min_Long,e.Dot_Max_Z,e.Dot_Min_Z);return f},a.DrawIsolinesWitchCustomGrid=function(a,b,c,d,e,f,g,h){return r(a,b,c,d,e,f,h,g)},a.DrawIsolinesWithExtrs=function(a,b,c,e){var f=d(a,e,c);return r(f.Grid,b,f.DeltaLat,f.DeltaLong,f.Grid_Min_Lat,f.Grid_Min_Long,f.Dot_Max_Z,f.Dot_Min_Z)},a.DrawIsolinesWithoutExtrs=function(a,b,c,d){var e=p(a,c,d);return r(e.Grid,b,e.DeltaLat,e.DeltaLong,e.Grid_Min_Lat,e.Grid_Min_Long,e.Dot_Max_Z,e.Dot_Min_Z)},a.IDW=function(a,b){var c,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},e=u(d,a),f=e.bbox,g=e.units,h=e.exponent,k=e.barriers,l=t(f,b,g[0]),m=l.latSize,n=l.longSize,o=l.degreeLatCellSize,p=l.degreeLongCellSize;if("degrees"===g[1])c=function(){var b=a.map(function(a){return[I(f[1]-a[0])/o,I(f[0]-a[1])/p,a[2]]}),c=[];if(k){k.forEach(function(a){for(var b,c=0;c<a.coordinates.length;c++)b=I(f[1]-a.coordinates[c][1])/o,a.coordinates[c][1]=I(f[0]-a.coordinates[c][0])/p,a.coordinates[c][0]=b});for(var d=0;d<m;d++){c[d]=[];for(var e=function(a){var e=[d+.5,a+.5],f=0,g=0;b.forEach(function(a){var b=0;k.forEach(function(c){var d=w(c,[a,e]);d&&(b+=d)});var c=D(D(e[0]-a[0],2)+D(e[1]-a[1],2),.5);f+=a[2]/D(c,h+b),g+=1/D(c,h+b)}),c[d][a]=f/g},g=0;g<n;g++)e(g)}}else for(var l=0;l<m;l++){c[l]=[];for(var q=function(a){var e=[l+.5,a+.5],f=0,g=0;b.forEach(function(a){var b=D(D(e[0]-a[0],2)+D(e[1]-a[1],2),2);f+=a[2]/D(b,h),g+=1/D(b,h)}),c[l][a]=f/g},r=0;r<n;r++)q(r)}return c}();else if("meters"===g[1])c=function(){for(var b=[],c=0;c<m;c++){b[c]=[];for(var d=function(d){var e=[f[1]+(c+.5)*o,f[0]+(d+.5)*p],g=0,i=0;a.forEach(function(a){var b=s(a,e);g+=a[2]/D(b,h),i+=1/D(b,h)}),b[c][d]=g/i},e=0;e<n;e++)d(e)}return b}();else throw new Error("\u043A\u0430\u043A \u0442\u0430\u043A\u043E\u0435 \u0432\u043E\u043E\u0431\u0449\u0435 \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E?");return{grid:c,latSize:m,longSize:n,degreeLatCellSize:o,degreeLongCellSize:p,bbox:f}},a.IDW2=function(a,b){var c,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},e=x(d,a),f=e.bbox,g=e.units,h=e.exponent,k=e.mask,l=e.buf,m=e.weightUp,n=e.weightDown,o=t(f,b,g[0]),p=o.latSize,q=o.longSize,r=o.degreeLatCellSize,u=o.degreeLongCellSize,v=l*Math.sqrt(2);if("degrees"===g[1])c=function(){for(var b=a.map(function(a){return[I(f[1]-a[0])/r,I(f[0]-a[1])/u,a[2]]}),c=[],d=function(e){c[e]=[];for(var d=function(g){var i=[e+.5,g+.5],j=0,l=0;b.forEach(function(b,c){var o=D(D(i[0]-b[0],2)+D(i[1]-b[1],2),.5);if(o<=v){var d=E(I(k.minlong-a[c][1])/k.delta),p=E(I(k.minlat-a[c][0])/k.delta),q=E(I(k.minlong-(g*u+f[0]))/k.delta),s=E(I(k.minlat-(e*r+f[1]))/k.delta),t=z(p,d,s,q,k.grid),w=0;t.forEach(function(a){t[0]+m[0]<=a?w+=m[1]:t[0]-n[0]>=a&&(w+=n[1])}),j+=b[2]/D(o,h+w),l+=1/D(o,h+w)}}),c[e][g]=j/l},g=0;g<q;g++)d(g)},e=0;e<p;e++)d(e);return c}();else if("meters"===g[1])c=function(){for(var b=[],c=0;c<p;c++){b[c]=[];for(var d=function(d){var e=[f[1]+(c+.5)*r,f[0]+(d+.5)*u],g=0,i=0;a.forEach(function(a){var b=s(a,e);g+=a[2]/D(b,h),i+=1/D(b,h)}),b[c][d]=g/i},e=0;e<q;e++)d(e)}return b}();else throw new Error("\u043A\u0430\u043A \u0442\u0430\u043A\u043E\u0435 \u0432\u043E\u043E\u0431\u0449\u0435 \u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E?");return{grid:c,latSize:p,longSize:q,degreeLatCellSize:r,degreeLongCellSize:u,bbox:f}},a.bezier=function(a){var b=[],c=[],d=!0;(a[0][0]!==a[a.length-1][0]||a[0][1]!==a[a.length-1][1])&&(d=!1);for(var e=0;e<a.length;e++){var f=void 0,g=void 0;if(0==e)d?(f=a[e+1],g=a[a.length-2]):(f=a[e+1],g=a[e]);else if(!(e===a.length-1))f=a[e+1],g=a[e-1];else if(d){b.push([b[0][0],b[0][1]]);break}else f=a[e],g=a[e-1];var h=[(f[0]-g[0])/2,(f[1]-g[1])/2],j=[a[e][0]-h[0]/3,a[e][1]-h[1]/3],k=[a[e][0]+h[0]/3,a[e][1]+h[1]/3];b.push([j,k])}for(var l=[],m=0;m<a.length-1;m++){l.push([a[m],b[m][1],b[m+1][0],a[m+1]]);for(var n=0;1>n;n+=.1){var o=D(1-n,3)*a[m][0]+3*D(1-n,2)*n*b[m][1][0]+3*(1-n)*D(n,2)*b[m+1][0][0]+D(n,3)*a[m+1][0],p=D(1-n,3)*a[m][1]+3*D(1-n,2)*n*b[m][1][1]+3*(1-n)*D(n,2)*b[m+1][0][1]+D(n,3)*a[m+1][1];c.push([o,p])}}return c},a.cellSizes=t,Object.defineProperty(a,"__esModule",{value:!0})});
